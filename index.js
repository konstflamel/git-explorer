some changes from master and changes from master-con
